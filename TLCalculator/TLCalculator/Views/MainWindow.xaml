<Window
    x:Class="TLCalculator.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:chart="clr-namespace:Syncfusion.UI.Xaml.Charts;assembly=Syncfusion.SfChart.WPF"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:sf="http://schemas.syncfusion.com/wpf"
    xmlns:uc="clr-namespace:TLCalculator.Views.UserControls"
    xmlns:xc="http://schemas.xceed.com/wpf/xaml/toolkit"
    x:Name="TLMainWindow"
    Title="{Binding Path=Title}"
    Width="1440"
    Height="800"
    Icon="/Views/TL_icon.png"
    SizeToContent="Height"
    mc:Ignorable="d" AllowDrop="True" Drop="TLMainWindow_Drop">
    <!--  ReSharper disable InconsistentNaming  -->
    <Window.InputBindings>
        <KeyBinding Command="{Binding Path=OpenDebugWindowCmd}" Gesture="Ctrl+Alt+D" />
        <KeyBinding Command="{Binding Path=SaveCurrentCmd}" Gesture="Ctrl+S" />
        <KeyBinding Command="{Binding Path=OpenFileCmd}" Gesture="Ctrl+O" />
        <KeyBinding Command="{Binding Path=NewCmd}" Gesture="Ctrl+N" />
        <KeyBinding Command="{Binding Path=ImportJBPanelCmd}" Gesture="Ctrl+I" />
    </Window.InputBindings>

    <DockPanel>
        <Menu DockPanel.Dock="Top" IsMainMenu="True">
            <MenuItem Header="文件(_F)">
                <MenuItem
                    Command="{Binding Path=NewCmd}"
                    Header="新建(_N)"
                    InputGestureText="Ctrl+N" />
                <MenuItem
                    Command="{Binding Path=OpenFileCmd}"
                    Header="打开(_O)..."
                    InputGestureText="Ctrl+O" />
                <MenuItem
                    Command="{Binding Path=SaveCurrentCmd}"
                    Header="保存(_S)"
                    InputGestureText="Ctrl+S" />
                <MenuItem
                    Command="{Binding Path=SaveAsCmd}"
                    Header="另存为(_A)..."
                    InputGestureText="Ctrl+A" />

                <Separator />
                <MenuItem Header="导入">
                    <MenuItem Command="{Binding Path=ImportJBPanelCmd}" Header="JX3BOX面板" InputGestureText="Ctrl+I"/>
                </MenuItem>

                <MenuItem Header="导出" />
                <Separator />
                <MenuItem Command="{Binding Path=CloseCmd}" Header="退出(_X)" />
            </MenuItem>

            <MenuItem Header="帮助(_H)">

                <MenuItem
                    Command="{Binding Path=OpenHelpCmd}"
                    CommandParameter="JB"
                    Header="使用帮助(_H)" />
                <MenuItem
                    Command="{Binding Path=OpenHelpCmd}"
                    CommandParameter="XF"
                    Header="入门攻略(_T)" />
                <Separator />
                <MenuItem
                    Command="{Binding Path=OpenHelpCmd}"
                    CommandParameter="WB"
                    Header="联系作者(_C)" />
                <Separator />
                <MenuItem
                    Command="{Binding Path=OpenHelpCmd}"
                    CommandParameter="JB"
                    Header="检查更新(_U)" />
                <MenuItem
                    Command="{Binding Path=OpenHelpCmd}"
                    CommandParameter="Git"
                    Header="项目主页(_G)" />

                <MenuItem Header="关于(_A)"
                          Command="{Binding Path=ShowAboutCmd}" />

            </MenuItem>


        </Menu>

        <Grid x:Name="Grid_Main">
            <!--  主界面  -->
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="10" />
                <ColumnDefinition Width="10.5*" />
                <ColumnDefinition Width="5" />
                <ColumnDefinition Width="6.5*" />
                <ColumnDefinition Width="5" />
                <ColumnDefinition Width="8*" />
            </Grid.ColumnDefinitions>
            <Grid.Resources>
                <Style BasedOn="{StaticResource Style.CenterLabel}" TargetType="Label" />
                <Style BasedOn="{StaticResource Style.CenterCheckBox}" TargetType="CheckBox" />
                <Style BasedOn="{StaticResource Style.IntUpDown}" TargetType="xc:IntegerUpDown" />
                <Style BasedOn="{StaticResource Style.ComboBoxItemStretch}" TargetType="ComboBoxItem" />
                <Style BasedOn="{StaticResource Style.ReadOnlyDataGrid}" TargetType="DataGrid" />
                <Style BasedOn="{StaticResource Style.CenterDataGridCell}" TargetType="DataGridCell" />
                <Style BasedOn="{StaticResource Style.CenterDataTextColumn}" TargetType="DataGridColumnHeader" />
                <Style BasedOn="{StaticResource Style.CenterSfDataGridCell}" TargetType="sf:GridCell" />
            </Grid.Resources>

            <!--  主界面（左半）  -->
            <Grid
                x:Name="Grid_Main_Left"
                Grid.Column="1"
                Margin="0,0,4,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>


                <GroupBox
                    x:Name="GroupBox_InitInput"
                    Grid.Row="0"
                    Height="Auto"
                    HorizontalAlignment="Stretch"
                    Header="初始属性输入">
                    <GroupBox.Resources>
                        <Style BasedOn="{StaticResource Style.CenterLabel}" TargetType="Label" />
                        <Style BasedOn="{StaticResource Style.CenterCheckBoxWithOutBind}" TargetType="CheckBox" />
                        <Style BasedOn="{StaticResource Style.IntUpDown_InitInput}" TargetType="xc:IntegerUpDown" />
                        <Style BasedOn="{StaticResource Style.PercentUpDown_InitInput}" TargetType="xc:DoubleUpDown" />
                    </GroupBox.Resources>

                    <TabControl x:Name="TabControl_InitChar">
                        <TabItem x:Name="TabItem_InitCharInput" Header="手动输入">

                            <Grid x:Name="Grid_InitChar">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*" MinWidth="300" />
                                    <ColumnDefinition Width="2" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <GroupBox
                                    x:Name="GroupBox_InitChar"
                                    Grid.Row="0"
                                    Grid.RowSpan="2"
                                    Grid.Column="0"
                                    Grid.ColumnSpan="1"
                                    Header="角色初始属性">
                                    <uc:InitCharPanel x:Name="InitCharPanelInput" />
                                </GroupBox>


                                <GroupBox
                                    Name="GroupBox_BigFM"
                                    Grid.Row="0"
                                    Grid.RowSpan="2"
                                    Grid.Column="2"
                                    Header="大附魔">
                                    <ItemsControl Name="ItemsControl_BigFMConfig"
                                                  Style="{StaticResource Style.BigFMConfig}" />
                                </GroupBox>


                                <GroupBox
                                    x:Name="GroupBox_EquipOption"
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    Header="装备效果">
                                    <Grid x:Name="Grid_EquipOption" MinWidth="150">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="5" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>

                                        <Grid.Resources>
                                            <Style TargetType="ComboBox">
                                                <Setter Property="Margin" Value="5" />
                                            </Style>
                                            <Style TargetType="CheckBox">
                                                <Setter Property="Margin" Value="7" />
                                            </Style>

                                        </Grid.Resources>


                                        <ComboBox
                                            x:Name="EquipOption_WP_cbb"
                                            Grid.Row="0"
                                            Grid.Column="0"
                                            Style="{StaticResource Style.EquipOptionCbb}" />

                                        <ComboBox
                                            x:Name="EquipOption_YZ_cbb"
                                            Grid.Row="0"
                                            Grid.Column="2"
                                            Style="{StaticResource Style.EquipOptionCbb}" />

                                        <Separator
                                            Grid.Row="2"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="3"
                                            Margin="0,5" />

                                        <CheckBox
                                            x:Name="EquipOption_JN_chb"
                                            Grid.Row="3"
                                            Grid.Column="0"
                                            Margin="5"
                                            IsChecked="{Binding Path=JN}"
                                            ToolTip="{Binding Path=JNToolTip}">
                                            套装：技能伤害
                                        </CheckBox>
                                        <CheckBox
                                            x:Name="EquipOption_SL_chb"
                                            Grid.Row="3"
                                            Grid.Column="2"
                                            Margin="5"
                                            IsChecked="{Binding Path=SL}"
                                            ToolTip="{Binding Path=SLToolTip}">
                                            套装：神力效果
                                        </CheckBox>
                                    </Grid>

                                </GroupBox>
                                <DockPanel Grid.Row="2" Grid.Column="2">
                                    <GroupBox
                                        x:Name="GroupBox_InitCharCommands"
                                        DockPanel.Dock="Top"
                                        Header="操作">
                                        <StackPanel Orientation="Vertical">
                                            <Button Margin="10 10"
                                                    Padding="5 5"
                                                x:Name="InitChar_ImportJB"
                                                Command="{Binding Path=ImportJBPanelCmd}"
                                                Content="导入JX3BOX配装属性" />
                                        </StackPanel>
                                    </GroupBox>

                                    <DockPanel DockPanel.Dock="Bottom">
                                        <TextBlock x:Name="Author_txb" HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontSize="15">
                                            作者：
                                            <Hyperlink Command="{Binding Path=OpenHelpCmd}"
                                                       CommandParameter="WB">
                                                @Zeratulag
                                            </Hyperlink>
                                        </TextBlock>

                                    </DockPanel>

                                </DockPanel>

                            </Grid>

                        </TabItem>
                        <TabItem x:Name="TabItem_InitCharPeiZhuang" Header="使用内置配装器">
                            <Image
                                Width="200"
                                Height="200"
                                Source="pack://application:,,,/Resource/Images/Gugugu.jpg" />
                        </TabItem>
                    </TabControl>
                </GroupBox>

                <DockPanel Grid.Row="1">
                    <GroupBox
                        x:Name="GroupBox_MiJi"
                        VerticalAlignment="Stretch"
                        DockPanel.Dock="Left"
                        Header="秘籍">
                        <GroupBox.Resources>
                            <Style BasedOn="{StaticResource Style.ExpanderMiJi}" TargetType="Expander" />

                            <Style BasedOn="{StaticResource Style.CenterCheckBox}" TargetType="CheckBox">
                                <Setter Property="FontSize" Value="11" />
                                <Setter Property="Margin" Value="5,2" />
                            </Style>

                            <Style BasedOn="{StaticResource Style.MiJiListView}" TargetType="ListView" />
                        </GroupBox.Resources>

                        <Grid x:Name="Grid_MiJi">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <Expander
                                x:Name="Expander_MiJi_JD"
                                Grid.Row="0"
                                Grid.Column="0">
                                <ListView x:Name="ListView_MiJi_JD" />
                            </Expander>

                            <Expander
                                x:Name="Expander_MiJi_TJ"
                                Grid.Row="0"
                                Grid.Column="1">
                                <ListView x:Name="ListView_MiJi_TJ" />
                            </Expander>

                            <Expander
                                x:Name="Expander_MiJi_BY"
                                Grid.Row="1"
                                Grid.Column="0">
                                <ListView x:Name="ListView_MiJi_BY" />
                            </Expander>

                            <Expander
                                x:Name="Expander_MiJi_TQ"
                                Grid.Row="1"
                                Grid.Column="1">
                                <ListView x:Name="ListView_MiJi_TQ" />
                            </Expander>

                        </Grid>

                    </GroupBox>

                    <GroupBox
                        x:Name="GroupBox_Debug"
                        MaxWidth="120"
                        DockPanel.Dock="Right"
                        Header="Debug">
                        <GroupBox.Resources>
                            <Style TargetType="Button">
                                <Setter Property="Margin" Value="5,2,2,5" />
                                <Setter Property="Padding" Value="0,3" />
                            </Style>
                        </GroupBox.Resources>
                        <StackPanel Orientation="Vertical">
                            <Button
                                x:Name="BtnOpenDebugWindow"
                                HorizontalContentAlignment="Center"
                                Command="{Binding Path=OpenDebugWindowCmd}">
                                <TextBlock HorizontalAlignment="Center">
                                    Debug窗口<LineBreak />
                                    (C+A+D)
                                </TextBlock>
                            </Button>
                            <Button x:Name="BtnExportMiJi" Click="BtnExportMiJi_Click">导出秘籍</Button>
                            <Button x:Name="BtnExportAll" Click="BtnExportAll_Click">导出全部</Button>
                        </StackPanel>

                    </GroupBox>

                </DockPanel>


                <GroupBox
                    x:Name="GroupBox_QiXue"
                    Grid.Row="2"
                    MinWidth="180"
                    Header="奇穴">

                    <Expander
                        x:Name="Expander_QiXue"
                        Header="{Binding Path=HeaderName}"
                        IsExpanded="True">
                        <ItemsControl x:Name="ItemsControl_QiXueConfig" Style="{StaticResource Style.QiXueConfig}" />
                    </Expander>

                </GroupBox>

            </Grid>

            <!--  主界面（中间）  -->
            <Grid
                x:Name="Grid_Main_Middle"
                Grid.Column="3"
                Grid.ColumnSpan="1"
                Margin="4,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>


                <GroupBox
                    x:Name="GroupBox_FightOption"
                    Grid.Row="0"
                    Grid.Column="0"
                    Header="战斗选项">
                    <Grid x:Name="Grid_FightOption">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Grid.Resources>
                            <Style BasedOn="{StaticResource Style.CenterRadioButton}" TargetType="RadioButton" />
                        </Grid.Resources>


                        <Label Grid.Row="0" Grid.Column="0">时长</Label>
                        <Grid Grid.Row="0" Grid.Column="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="15*" />
                                <ColumnDefinition Width="10*" />
                                <ColumnDefinition Width="10*" />
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <xc:IntegerUpDown
                                    x:Name="FightTime_spb"
                                    MinWidth="50"
                                    HorizontalAlignment="Left"
                                    FontSize="16"
                                    Increment="10"
                                    Minimum="180"
                                    Style="{StaticResource Style.IntUpDown_InitInput}"
                                    Text="300"
                                    Value="{Binding Path=FightTime}" />
                                <Label>秒</Label>
                            </StackPanel>

                            <RadioButton
                                x:Name="LongFight_rbt"
                                Grid.Column="1"
                                GroupName="FightTime"
                                IsChecked="{Binding Path=LongFight}"
                                ToolTip="模拟副本长时间战斗">
                                长时间
                            </RadioButton>
                            <RadioButton
                                x:Name="ShortFight_rbt"
                                Grid.Column="2"
                                GroupName="FightTime"
                                IsChecked="{Binding Path=ShortFight}"
                                ToolTip="模拟木桩战斗（起手有一波心无）">
                                短时间
                            </RadioButton>

                        </Grid>

                        <Label Grid.Row="1" Grid.Column="0">目标</Label>


                        <Grid Grid.Row="1" Grid.Column="1">

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="15*" />
                                <ColumnDefinition Width="6*" />
                                <ColumnDefinition Width="8*" />
                            </Grid.ColumnDefinitions>

                            <ComboBox
                                x:Name="FightOption_Target_cbb"
                                Grid.Column="0"
                                Margin="5,5"
                                DisplayMemberPath="ItemName"
                                Style="{StaticResource Style.FightOptionCbb}" />

                            <Label
                                Grid.Column="1"
                                Margin="5,5,0,5"
                                HorizontalAlignment="Right"
                                DockPanel.Dock="Right">
                                手法
                            </Label>
                            <ComboBox
                                x:Name="FightOption_Ability_cbb"
                                Grid.Column="2"
                                MinWidth="30"
                                Margin="0,5"
                                DisplayMemberPath="ItemName"
                                Style="{StaticResource Style.FightOptionCbb}"
                                />

                        </Grid>


                        <Label Grid.Row="2" Grid.Column="0">阵法</Label>
                        <DockPanel
                            Grid.Row="2"
                            Grid.Column="1"
                            LastChildFill="False">

                            <ComboBox
                                x:Name="FightOption_ZhenFa_cbb"
                                Margin="5,5"
                                DataContext="{Binding Path=ZhenFa}"
                                Style="{StaticResource Style.ZhenFaCbb}" />

                        </DockPanel>

                    </Grid>


                </GroupBox>


                <GroupBox
                    x:Name="GroupBox_Buff"
                    Grid.Row="1"
                    Header="BUFF">
                    <ScrollViewer MaxHeight="300">
                        <StackPanel x:Name="Grid_Buff">

                            <Expander x:Name="Expander_Buff_Self">
                                <Expander.Header>
                                    <TextBlock Text="{Binding Path=Header}" TextWrapping="Wrap" />
                                </Expander.Header>
                                <ListView x:Name="ListView_Buff_Self" Style="{StaticResource Style.BaseBuffListView}" />
                            </Expander>

                            <Expander x:Name="Expander_Buff_Banquet">
                                <Expander.Header>
                                    <TextBlock Text="{Binding Path=Header}" TextWrapping="Wrap" />
                                </Expander.Header>
                                <ListView x:Name="ListView_Buff_Banquet"
                                          Style="{StaticResource Style.BaseBuffListView}" />
                            </Expander>

                            <Expander x:Name="Expander_Buff_Normal">
                                <Expander.Header>
                                    <TextBlock Text="{Binding Path=Header}" TextWrapping="Wrap" />
                                </Expander.Header>
                                <ListView x:Name="ListView_Buff_Normal" Style="{StaticResource Style.BaseBuffListView}" />
                            </Expander>

                            <Expander x:Name="Expander_DeBuff_Normal">
                                <Expander.Header>
                                    <TextBlock Text="{Binding Path=Header}" TextWrapping="Wrap" />
                                </Expander.Header>
                                <ListView x:Name="ListView_DeBuff_Normal"
                                          Style="{StaticResource Style.BaseBuffListView}" />
                            </Expander>

                            <Expander x:Name="Expander_Buff_Extra">
                                <Expander.Header>
                                    <TextBlock Text="{Binding Path=Header}" TextWrapping="Wrap" />
                                </Expander.Header>
                                <ListView x:Name="ListView_Buff_Extra" Style="{StaticResource Style.ExtraBuffListView}" />
                            </Expander>

                            <Expander x:Name="Expander_Buff_ExtraStack">
                                <Expander.Header>
                                    <TextBlock Text="{Binding Path=Header}" TextWrapping="Wrap" />
                                </Expander.Header>
                                <ListView x:Name="ListView_Buff_ExtraStack"
                                          Style="{StaticResource Style.ExtraStackBuffListView}" />
                            </Expander>

                        </StackPanel>
                    </ScrollViewer>

                </GroupBox>

                <GroupBox Name="GroupBox_ItemDT" Grid.Row="2">
                    <GroupBox.Header>
                        <CheckBox x:Name="GroupBox_ItemDT_chb" Style="{StaticResource Style.CenterCheckBox}">单体</CheckBox>
                    </GroupBox.Header>
                    <Expander
                        x:Name="Expander_ItemDT"
                        IsExpanded="True"
                        Style="{StaticResource Style.MultiLineHeaderedExpander}">
                        <ScrollViewer MaxHeight="210">
                            <ItemsControl x:Name="ItemsControl_ItemDT" Style="{StaticResource Style.ItemDT}" />
                        </ScrollViewer>
                    </Expander>
                </GroupBox>

            </Grid>

            <!--  主界面（右半）  -->

            <Grid Name="Grid_Main_Right" Grid.Column="5">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>


                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <GroupBox
                    x:Name="GroupBox_DPS"
                    Grid.Row="0"
                    Grid.Column="0"
                    Header="DPS期望">
                    <Grid x:Name="Grid_DPS">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" MinWidth="200" />
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <TextBlock
                            Name="FinalDPS_txb"
                            Grid.Column="0"
                            Margin="10,10,10,5"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontSize="24"
                            FontWeight="Bold"
                            Foreground="Red"
                            Text="{Binding Path=FinalDPStxt}"
                            MouseLeftButtonDown="CopyFinalDPS"
                            ToolTip="点击复制"/>
                        <Popup x:Name="CopyTextblock_pop" StaysOpen="False" Placement="Mouse" PopupAnimation="Slide" AllowsTransparency="True">
                            <Border BorderBrush="Beige" BorderThickness="2" Background="White">
                                <TextBlock Margin="5">已复制！</TextBlock>
                            </Border>

                        </Popup>

                        <Expander Grid.Column="1" ExpandDirection="Right">
                            <DataGrid
                                Name="DataGrid_DPSTable"
                                AutoGenerateColumns="False"
                                ItemsSource="{Binding Path=DPSTable}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Path=DescName}" Header="时段" />
                                    <DataGridTextColumn Binding="{Binding Path=DPS, StringFormat={}{0:F0}}"
                                                        Header="DPS" />
                                    <DataGridTextColumn Binding="{Binding Path=Proportion, StringFormat={}{0:P2}}"
                                                        Header="占比" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </Expander>
                        <Expander x:Name="Expander_CombatStat"
                            Grid.Row="1"
                            Grid.Column="0"
                            Grid.ColumnSpan="2"
                            Header="战斗统计"
                            IsExpanded="True">
                            <sf:SfDataGrid
                                x:Name="SfDataGrid_SimpleCombatStatTable"
                                Width="Auto"
                                Height="Auto"
                                Margin="5"
                                HorizontalAlignment="Stretch"
                                AllowResizingColumns="True"
                                AutoGenerateColumns="False"
                                ColumnSizer="AutoLastColumnFill"
                                ItemsSource="{Binding Path=SimpleCombatStatTable}"
                                RowHeight="20">
                                <sf:SfDataGrid.Columns>
                                    <sf:GridTextColumn
                                        Width="20"
                                        HeaderText="#"
                                        MappingName="Rank"
                                        TextAlignment="Center" />

                                    <sf:GridTextColumn
                                        Width="100"
                                        HeaderText="技能"
                                        HorizontalHeaderContentAlignment="Center"
                                        MappingName="Name" />

                                    <sf:GridNumericColumn
                                        Width="50"
                                        HeaderText="次数"
                                        MappingName="ShowNum"
                                        NumberDecimalDigits="1" />
                                    <sf:GridPercentColumn
                                        Width="60"
                                        HeaderText="会心"
                                        MappingName="CTRatePct" />
                                    <sf:GridNumericColumn
                                        Width="70"
                                        HeaderText="伤害"
                                        MappingName="TotalDamage"
                                        NumberDecimalDigits="0" />
                                    <sf:GridNumericColumn
                                        Width="90"
                                        HeaderText="比重"
                                        MappingName="ProportionPct"
                                        SetCellBoundValue="True">
                                        <sf:GridNumericColumn.CellTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <ProgressBar
                                                        x:Name="progressBar"
                                                        Height="15"
                                                        Background="Transparent"
                                                        BorderThickness="0"
                                                        Foreground="Green"
                                                        Maximum="60"
                                                        Minimum="0"
                                                        Visibility="Visible"
                                                        Value="{Binding Path=Value}" />
                                                    <TextBlock
                                                        HorizontalAlignment="Right"
                                                        VerticalAlignment="Center"
                                                        Text="{Binding Path=Value, StringFormat='\{0\}%'}"
                                                        TextAlignment="Center" />
                                                </Grid>
                                            </DataTemplate>
                                        </sf:GridNumericColumn.CellTemplate>
                                    </sf:GridNumericColumn>
                                </sf:SfDataGrid.Columns>
                            </sf:SfDataGrid>
                        </Expander>
                    </Grid>
                </GroupBox>

                <GroupBox
                    x:Name="GroupBox_Profit"
                    Grid.Row="1"
                    MinWidth="400"
                    Header="属性收益"
                    MouseLeftButtonDown="GroupBox_Profit_MouseDown"
                    ToolTip="点击复制">

                    <Expander IsExpanded="True">
                        <Expander.Header>
                            <TextBox
                                FontSize="14"
                                FontWeight="Bold"
                                Foreground="Red"
                                Text="{Binding Path=ProfitOrderDesc}" 
                                Style="{StaticResource Style.TextBlockBox}"
                                />
                        </Expander.Header>
                        <StackPanel Orientation="Vertical">

                            <StackPanel Orientation="Horizontal">
                                <Label Margin="5">依据</Label>
                                <ComboBox
                                    x:Name="ProfitWeight_cbb"
                                    Width="100"
                                    Margin="5"
                                    Style="{StaticResource Style.ProfitWeightCbb}" />
                            </StackPanel>

                            <chart:SfChart
                                x:Name="ProfitChart"
                                MaxWidth="400"
                                MaxHeight="250"
                                Margin="0,5,0,0"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Stretch"
                                Header="{Binding Path=Header}"
                                FontSize="15">
                                <!--  Initialize the horizontal axis for the WPF Chart  -->
                                <chart:SfChart.PrimaryAxis>
                                    <chart:CategoryAxis FontSize="12" ShowGridLines="False" />
                                </chart:SfChart.PrimaryAxis>

                                <!--  Initialize the vertical axis for the WPF Chart  -->
                                <chart:SfChart.SecondaryAxis>
                                    <chart:NumericalAxis FontSize="14" />
                                </chart:SfChart.SecondaryAxis>

                                <!--  Adding Column Series to the WPF Chart  -->
                                <chart:BarSeries
                                    EnableAnimation="True"
                                    ItemsSource="{Binding Path=Data}"
                                    Palette="Elite"
                                    ShowTooltip="True"
                                    XBindingPath="DescName"
                                    YBindingPath="Value">
                                    <chart:BarSeries.AdornmentsInfo>
                                        <chart:ChartAdornmentInfo
                                            Background="Transparent"
                                            LabelPosition="Inner"
                                            ShowLabel="True"
                                            ShowMarker="True" />
                                    </chart:BarSeries.AdornmentsInfo>

                                    <chart:BarSeries.TooltipTemplate>
                                        <DataTemplate>
                                            <TextBlock
                                                HorizontalAlignment="Right"
                                                Foreground="White"
                                                Text="{Binding Path=Item.Value, StringFormat='{}{0:F3}'}" 
                                                FontSize="12"/>
                                        </DataTemplate>
                                    </chart:BarSeries.TooltipTemplate>

                                </chart:BarSeries>

                                <!--
                        <chart:SfChart.Behaviors>
                            <chart:ChartSelectionBehavior EnableSegmentSelection="True" EnableSeriesSelection="True" />
                        </chart:SfChart.Behaviors>-->

                            </chart:SfChart>

                        </StackPanel>


                    </Expander>

                </GroupBox>

                <GroupBox x:Name="GroupBox_Optimization"  Grid.Row="2">
                    <GroupBox.Header>
                        <CheckBox x:Name="GroupBox_Optimization_chb" Style="{StaticResource Style.CenterCheckBox}" IsChecked="True">优化分析</CheckBox>
                    </GroupBox.Header>

                    <TabControl Visibility="{Binding IsChecked,ElementName=GroupBox_Optimization_chb,Converter={StaticResource BooleanToVisibility}}" SelectionChanged="TabControl_SelectionChanged">
                        <TabItem Header="最优初始属性">

                            <TextBlock Text="{Binding Path=OptimizationDesc}" MouseLeftButtonDown="CopyTextBlock"></TextBlock>

                        </TabItem>
                        <TabItem Header="多重阵眼比较" x:Name="TabItem_MultiZhen">

                            <sf:SfDataGrid
                                x:Name="SfDataGrid_MultiZhen"
                                Width="Auto"
                                Height="Auto"
                                Margin="5"
                                HorizontalAlignment="Stretch"
                                AllowResizingColumns="True"
                                AutoGenerateColumns="False"
                                ColumnSizer="AutoLastColumnFill"
                                ItemsSource="{Binding Path=MultiZhenTable}"
                                RowHeight="20">
                                <sf:SfDataGrid.Columns>
                                    <sf:GridTextColumn
                                        Width="30"
                                        HeaderText="#"
                                        MappingName="Rank"
                                        TextAlignment="Center" />

                                    <sf:GridTextColumn
                                        Width="100"
                                        HeaderText="阵法"
                                        HorizontalHeaderContentAlignment="Center"
                                        MappingName="Name" />

                                    <sf:GridNumericColumn
                                        Width="80"
                                        HeaderText="DPS"
                                        MappingName="DPS"
                                        NumberDecimalDigits="0" />
                                    <sf:GridNumericColumn
                                        Width="120"
                                        HeaderText="相对"
                                        MappingName="RelativePct"
                                        SetCellBoundValue="True">
                                        <sf:GridNumericColumn.CellTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <ProgressBar
                                                        x:Name="progressBar"
                                                        Height="15"
                                                        Background="Transparent"
                                                        BorderThickness="0"
                                                        Foreground="IndianRed"
                                                        Maximum="130"
                                                        Minimum="100"
                                                        Visibility="Visible"
                                                        Value="{Binding Path=Value}" />
                                                    <TextBlock
                                                        HorizontalAlignment="Right"
                                                        VerticalAlignment="Center"
                                                        Text="{Binding Path=Value, StringFormat='\{0\}%'}"
                                                        TextAlignment="Center" />
                                                </Grid>
                                            </DataTemplate>
                                        </sf:GridNumericColumn.CellTemplate>
                                    </sf:GridNumericColumn>
                                </sf:SfDataGrid.Columns>
                            </sf:SfDataGrid>


                        </TabItem>
                    </TabControl>
                </GroupBox>

            </Grid>
        </Grid>

    </DockPanel>

</Window>